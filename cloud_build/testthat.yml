steps:
  - name: gcr.io/gcer-public/packagetools:latest
    args:
      - Rscript
      - -e
      - |-
        message("cran mirror: ", getOption("repos"))
        remotes::install_deps(dependencies = TRUE)
        rcmdcheck::rcmdcheck(args = '--no-manual', error_on = 'warning')
    env:
      - NOT_CRAN=true
  - name: gcr.io/gcer-public/packagetools:latest
    args:
      - Rscript
      - -e
      - |-
        remotes::install_deps(dependencies = TRUE)
        remotes::install_local()
        cv <- covr::package_coverage()
        covr::codecov(coverage=cv,
                      commit = '$COMMIT_SHA', branch = '$BRANCH_NAME',
                      quiet = FALSE)
    env:
      - NOT_CRAN=true
      - CODECOV_TOKEN=$_CODECOV_TOKEN
      - GCB_PROJECT_ID=$PROJECT_ID
      - GCB_BUILD_ID=$BUILD_ID
      - GCB_COMMIT_SHA=$COMMIT_SHA
      - GCB_REPO_NAME=$REPO_NAME
      - GCB_BRANCH_NAME=$BRANCH_NAME
      - GCB_TAG_NAME=$TAG_NAME
      - GCB_HEAD_BRANCH=$_HEAD_BRANCH
      - GCB_BASE_BRANCH=$_BASE_BRANCH
      - GCB_HEAD_REPO_URL=$_HEAD_REPO_URL
      - GCB_PR_NUMBER=$_PR_NUMBER
#Generated by googleCloudRunner::cr_build_write at 2021-04-09 16:33:28
